# 练习1: 给未被映射的地址映射上物理页

## 关于`do_pgfault`函数

`函数调用关系`: `trap`--> `trap_dispatch`-->`pgfault_handler`-->`do_pgfault`



`do_pgfault` -  处理页错误异常的中断处理函数

`mm` - 同一页目录表中的虚拟内存区域的控制结构体的集合

`error_code` - 错误码,从硬件中设置的`trapframe->tf_err`读取

`addr` - 内存访问异常的发生的地址(存于`CR2`寄存器的值)



这个处理过程提供一个`do_pgfault`函数,这个函数使用两个参数,用以诊断以及修复异常.

- 参数1:`CR2`寄存器的值.这个处理过程载入`CR2`的值(`CR2`中有一个由异常所生成的32位线性地址).`do_pgfault`函数用此以定位异常的发生的所在页目录和页表项.
- 参数2:内核栈中的错误码.页错误的错误码有于其他情况(的错误码)不同的格式.这个错误码告诉我们三个有关异常处理的要素.
  - P 标志位 (0号bit位) .指明这个异常的发生是否由(页不存在/访问权限错误和访问保留区域)所触发.(0/1)
  - W/R 标志位 (1号bit位) 指明这个异常的发生是否由(读操作/写操作)所触发.(0/1)
  - U/S 标志位 (2号bit位) 指明这个异常处理过程在(用户模式/特权模式)下执行处理.(1/0)

